
# ğŸ¥ åŒ»é™¢ç³»ç»Ÿ API æ–‡æ¡£ (RESTful + JSON)

**Base URLï¼š** `/api`

---

# 1. è®¤è¯æ¨¡å—ï¼ˆAuthï¼‰

## **POST /api/login**

åŒ»ç”Ÿç™»å½•ç³»ç»Ÿ

### Request

```json
{
  "username": "zhangsan",
  "password": "123456"
}
```

### Response

```json
{
  "token": "jwt-token-string",
  "doctor": {
    "id": 1,
    "name": "å¼ ä¸‰",
    "department": "å†…ç§‘"
  }
}
```

---

# 2. æ‚£è€…ï¼ˆPatientï¼‰

## **GET /api/patients**

è·å–æ‚£è€…åˆ—è¡¨ï¼ˆæ”¯æŒæœç´¢ï¼‰

### Query Params

* `name`ï¼ˆå¯é€‰ï¼‰
* `phone`ï¼ˆå¯é€‰ï¼‰

### Response

```json
[
  {
    "id": 1,
    "name": "ç‹å¤§é”¤",
    "phone": "13800000000",
    "id_number": "110101199901017654"
  }
]
```

## **POST /api/patients**

æ–°å¢æ‚£è€…

### Request

```json
{
  "name": "æå°èŠ±",
  "phone": "13900000000",
  "id_number": "110101200001015588"
}
```

### Response

```json
{
  "id": 5,
  "name": "æå°èŠ±",
  "phone": "13900000000",
  "id_number": "110101200001015588"
}
```

---

# 3. å°±è¯Šè®°å½•ï¼ˆVisitï¼‰

## **POST /api/visits**

åˆ›å»ºæ–°çš„å°±è¯Šè®°å½•ï¼ˆæŒ‚å·ï¼‰

### Request

```json
{
  "patient_id": 1,
  "department": "å†…ç§‘"
}
```

### Response

```json
{
  "id": 10,
  "patient_id": 1,
  "department": "å†…ç§‘",
  "number": 23,
  "status": "waiting",
  "created_at": "2025-12-09T10:00:00"
}
```

---

## **GET /api/visits?department=å†…ç§‘&status=waiting**

æŒ‰ç§‘å®¤æŸ¥çœ‹æ’é˜Ÿæƒ…å†µ

### Response

```json
[
  {
    "id": 10,
    "patient_id": 1,
    "number": 23,
    "status": "waiting"
  }
]
```

---

## **PATCH /api/visits/{id}/status**

æ›´æ–°å°±è¯ŠçŠ¶æ€ï¼ˆåŒ»ç”Ÿæ“ä½œï¼‰

ä¾‹å¦‚ï¼šwaiting â†’ in_progress â†’ finished â†’ dispensed

### Request

```json
{
  "status": "in_progress"
}
```

### Response

```json
{ "success": true }
```

---

# 4. ç”µå­ç—…å†ï¼ˆEMRï¼‰

## **POST /api/emrs**

åˆ›å»ºç”µå­ç—…å†ï¼ˆå®Œæˆé—®è¯Šåï¼‰

### Request

```json
{
  "visit_id": 10,
  "chief_complaint": "å‘çƒ­ä¸‰å¤©",
  "diagnosis": "ä¸Šå‘¼å¸é“æ„ŸæŸ“",
  "treatment": "å¯¹ç—‡æ²»ç–— + å¤šå–æ°´"
}
```

### Response

```json
{
  "id": 6,
  "visit_id": 10,
  "created_at": "2025-12-09T10:20:00"
}
```

---

## **GET /api/emrs/{id}**

è·å–ç”µå­ç—…å†è¯¦æƒ…

### Response

```json
{
  "id": 6,
  "visit_id": 10,
  "chief_complaint": "å‘çƒ­ä¸‰å¤©",
  "diagnosis": "ä¸Šå‘¼å¸é“æ„ŸæŸ“",
  "treatment": "å¯¹ç—‡æ²»ç–— + å¤šå–æ°´",
  "created_at": "2025-12-09T10:20:00"
}
```

---

# 5. å¤„æ–¹ï¼ˆPrescriptionï¼‰

## **POST /api/prescriptions**

åˆ›å»ºå¤„æ–¹

### Request

```json
{
  "emr_id": 6
}
```

### Response

```json
{
  "id": 12,
  "status": "pending",
  "created_at": "2025-12-09T10:21:00"
}
```

---

# 6. å¤„æ–¹æ˜ç»†ï¼ˆPrescriptionItemï¼‰

## **POST /api/prescription_items**

æ·»åŠ è¯å“åˆ°å¤„æ–¹

### Request

```json
{
  "prescription_id": 12,
  "drug_id": 4,
  "quantity": 3,
  "days": 5
}
```

### Response

```json
{
  "id": 33,
  "prescription_id": 12,
  "drug_id": 4,
  "quantity": 3,
  "days": 5
}
```

---

# 7. è¯æˆ¿å‘è¯

## **PATCH /api/prescriptions/{id}/dispense**

è¯å‰‚å¸ˆå‘è¯ â†’ pending â†’ dispensed

### Response

```json
{ "success": true }
```

---

# 8. è¯å“ï¼ˆDrugï¼‰

## **GET /api/drugs**

è·å–æ‰€æœ‰è¯å“

### Response

```json
[
  { "id": 1, "name": "é˜¿è«è¥¿æ—èƒ¶å›Š" },
  { "id": 2, "name": "å¸ƒæ´›èŠ¬" }
]
```

---

# 9. åŒ»ç”Ÿï¼ˆDoctorï¼‰

## **GET /api/doctors**

è·å–æ‰€æœ‰åŒ»ç”Ÿ

### Response

```json
[
  {
    "id": 1,
    "name": "å¼ ä¸‰",
    "username": "zhangsan",
    "department": "å†…ç§‘"
  }
]
```
